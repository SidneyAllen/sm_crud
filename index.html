<!DOCTYPE html> 
<html>
  <head>
    <title>StackMob - ToDo</title>
 

    <link rel="stylesheet" href="vendor/jquery.mobile-1.1.1.min.css" />
 

    <!-- templates -->
    <script type="text/template" id="listItemTemplate">    
        <li>
          <a href="#update/<%= todo_id %>" data-id="<%= todo_id %>"><%= name %></a>
        </li>
    </script>


    <script type="text/template" id="home">
        <div data-role="header">
            <a href="#add" data-role="button" data-icon="add">Add</a>
            <h1>StackMob ToDo</h1>
        </div>
        <div data-role="content"></div>
    </script>

    <script type="text/template" id="add">
        <div data-role="header">
            <a href="#" data-icon="back" class="back ui-btn-left">Back</a>
            <h1>Add ToDo</h1>
        </div>
        <div data-role="content">
            <form name="addForm" id="addForm">
                <input type="text" name="name" id="name" placeholder="new tod" value="">
                <input type="button" id="addBtn" value="add">
            </form>
        </div>
    </script>

    <script type="text/template" id="update">
        <div data-role="header">
            <a href="#" data-icon="back" class="back ui-btn-left">Back</a>
            <h1>Update ToDo</h1>
        </div>
        <div data-role="content">
            <form name="updateForm" id="updateForm">
                <input type="text" name="name" id="name" value="<%=  name %>">
                <input type="button" id="updateBtn" value="save">
                <input type="button" id="deleteBtn" value="delete">
            </form>
        </div>
    </script>

    <script src="vendor/jquery-1.6.4.min.js"></script>

    <script type="text/javascript">
      $(document).bind("mobileinit", function(){
          $.mobile.page.prototype.options.addBackBtn= false;
          $.mobile.ajaxEnabled = false;
          $.mobile.linkBindingEnabled = false;
          $.mobile.hashListeningEnabled = false;
          $.mobile.pushStateEnabled = false;

           // Remove page from DOM when it's being replaced
          $('div[data-role="page"]').live('pagehide', function (event, ui) {
              $(event.currentTarget).remove();
          });
      });
    </script>

     <script src="vendor/jquery.mobile-1.1.1.min.js"></script>

    <script type="text/javascript" src="vendor/json2-min.js"></script>
    <script type="text/javascript" src="vendor/underscore-1.3.0-min.js"></script>
    <script type="text/javascript" src="vendor/backbone-0.9.2-min.js"></script>
    <script type="text/javascript" src="vendor/stackmob-js-0.5.5-min.js"></script>

    <!-- App specific scripts -->
    <script src="js/app.js"></script>
    
    <!-- maximum scale added to stop zoom on select controls -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  </head>
  <body>



    <div id="fb-root"></div>
    <script>
      // Load the SDK Asynchronously
      (function(d){
         var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement('script'); js.id = id; js.async = true;
         js.src = "//connect.facebook.net/en_US/all.js";
         ref.parentNode.insertBefore(js, ref);
       }(document));

      // Init the SDK upon load
      window.fbAsyncInit = function() {
        FB.init({
          appId      : 'YOUR_APP_ID', // App ID
          channelUrl : '//'+window.location.hostname+'/channel.html', // Path to your Channel File
          status     : true, // check login status
          cookie     : true, // enable cookies to allow the server to access the session
          xfbml      : true  // parse XFBML
        });

        // listen for and handle auth.statusChange events
        FB.Event.subscribe('auth.statusChange', function(response) {
          if (response.authResponse) {
            // user has auth'd your app and is logged into Facebook
            FB.api('/me', function(me){
              if (me.name) {
                document.getElementById('auth-displayname').innerHTML = me.name;
              }
            })
            document.getElementById('auth-loggedout').style.display = 'none';
            document.getElementById('auth-loggedin').style.display = 'block';
          } else {
            // user has not auth'd your app, or is not logged into Facebook
            document.getElementById('auth-loggedout').style.display = 'block';
            document.getElementById('auth-loggedin').style.display = 'none';
          }
        });

        // respond to clicks on the login and logout links
        document.getElementById('auth-loginlink').addEventListener('click', function(){
          FB.login();
        });
        document.getElementById('auth-logoutlink').addEventListener('click', function(){
          FB.logout();
        }); 
      } 
    </script>

    <h1>Facebook Client-side Authentication Example</h1>
      <div id="auth-status">
        <div id="auth-loggedout">
          <a href="#" id="auth-loginlink">Login</a>
        </div>
        <div id="auth-loggedin" style="display:none">
          Hi, <span id="auth-displayname"></span>  
        (<a href="#" id="auth-logoutlink">logout</a>)
      </div>
    </div>

  </body>
</html>
